{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from \"react\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport * as Location from \"expo-location\";\nimport MapView, { Marker, Callout } from \"react-native-maps\";\nimport { Button, FAB } from \"@react-native-material/core\";\nimport moment from \"moment\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { changeInfo } from \"../features/userStore\";\nimport { changeInfoUser, entradaTikada, salidaTikada } from \"../api\";\nimport fondo from \"../assets/fondoScreen.jpg\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport default function App(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      location = _useState2[0],\n      setLocation = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errorMsg = _useState4[0],\n      setErrorMsg = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      fecha = _useState6[0],\n      setFecha = _useState6[1];\n\n  var user = useSelector(function (state) {\n    return state.userStore;\n  });\n  var dispatch = useDispatch();\n\n  var handleTikado = function handleTikado() {\n    if (user.tikado == false) {\n      dispatch(changeInfo(!user.tikado));\n      changeInfoUser(user._id, !user.tikado);\n      var newTikada = {\n        idEmpleado: user._id,\n        estado: \"abierta\",\n        entrada: fecha,\n        salida: \"Ninguna\",\n        mes: \"Septiembre\",\n        comentario: \"Ninguno\"\n      };\n      entradaTikada(newTikada);\n      navigation.navigate(\"TabScreen\");\n    } else {\n      Alert.alert(\"No puedes tikar la entrada si ya has tikado\");\n    }\n  };\n\n  var handleSalida = function handleSalida() {\n    if (user.tikado == true) {\n      dispatch(changeInfo(!user.tikado));\n      changeInfoUser(user._id, !user.tikado);\n      var newSalida = {\n        salida: fecha\n      };\n      salidaTikada(user._id, newSalida);\n      navigation.navigate(\"TabScreen\");\n    } else {\n      Alert.alert(\"No puedes tikar la salida si no has tikado la entrada\");\n    }\n  };\n\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          status = _yield$Location$reque.status;\n\n      if (status !== \"granted\") {\n        setErrorMsg(\"Permission to access location was denied\");\n        return;\n      }\n\n      var location = yield Location.getCurrentPositionAsync({});\n      setLocation(location);\n    })();\n\n    var newDay = moment().format(\"DD/MM/YYYY HH:mm:ss \");\n    setFecha(newDay);\n  }, []);\n  var text = \"Waiting..\";\n\n  if (errorMsg) {\n    text = errorMsg;\n  } else if (location) {\n    text = JSON.stringify(location);\n  }\n\n  return _jsx(View, {\n    children: location === null ? _jsx(ImageBackground, {\n      source: fondo,\n      resizeMode: \"cover\",\n      style: {\n        flex: 1,\n        justifyContent: \"center\"\n      }\n    }) : _jsxs(_Fragment, {\n      children: [_jsxs(View, {\n        style: {\n          position: \"absolute\",\n          zIndex: 1000,\n          backgroundColor: \"#00000099\",\n          height: 150,\n          width: \"90%\",\n          top: \"5%\",\n          left: \"5%\",\n          right: 0,\n          bottom: 40,\n          padding: 10,\n          borderRadius: 5,\n          alignItems: \"center\"\n        },\n        children: [_jsx(View, {\n          style: {\n            backgroundColor: \"#ffffff\",\n            width: \"80%\",\n            height: 50,\n            marginVertical: 10,\n            borderRadius: 10,\n            justifyContent: \"center\"\n          },\n          children: _jsx(Text, {\n            style: {\n              textAlign: \"center\",\n              fontSize: 18\n            },\n            children: fecha\n          })\n        }), _jsxs(View, {\n          style: {\n            flexDirection: \"row\"\n          },\n          children: [_jsx(Button, {\n            onPress: handleTikado,\n            title: \"Entrada\",\n            style: {\n              marginRight: 5,\n              backgroundColor: \"green\",\n              width: 145,\n              padding: 5\n            }\n          }), _jsx(Button, {\n            onPress: handleSalida,\n            title: \"Salida\",\n            style: {\n              backgroundColor: \"red\",\n              width: 145,\n              padding: 5\n            }\n          })]\n        })]\n      }), _jsx(MapView, {\n        region: {\n          latitude: location.coords.latitude,\n          longitude: location.coords.longitude,\n          latitudeDelta: 0.0922,\n          longitudeDelta: 0.0421\n        },\n        style: {\n          width: \"100%\",\n          height: \"100%\"\n        },\n        children: _jsx(Marker, {\n          coordinate: {\n            latitude: location.coords.latitude,\n            longitude: location.coords.longitude\n          },\n          title: \"Dia 5\",\n          description: \"Hora: 20:00\",\n          children: _jsx(Callout, {\n            tooltip: true\n          })\n        }, \"1\")\n      })]\n    })\n  });\n}","map":{"version":3,"names":["React","useState","useEffect","Location","MapView","Marker","Callout","Button","FAB","moment","useSelector","useDispatch","changeInfo","changeInfoUser","entradaTikada","salidaTikada","fondo","App","navigation","location","setLocation","errorMsg","setErrorMsg","fecha","setFecha","user","state","userStore","dispatch","handleTikado","tikado","_id","newTikada","idEmpleado","estado","entrada","salida","mes","comentario","navigate","Alert","alert","handleSalida","newSalida","requestForegroundPermissionsAsync","status","getCurrentPositionAsync","newDay","format","text","JSON","stringify","flex","justifyContent","position","zIndex","backgroundColor","height","width","top","left","right","bottom","padding","borderRadius","alignItems","marginVertical","textAlign","fontSize","flexDirection","marginRight","latitude","coords","longitude","latitudeDelta","longitudeDelta"],"sources":["C:/Users/xabig/Desktop/ProyectoPiconera2/clientev2/screens/TikadaScreen.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Platform, Text, View, StyleSheet, Alert } from \"react-native\";\r\nimport * as Location from \"expo-location\";\r\nimport MapView, { Marker, Callout } from \"react-native-maps\";\r\nimport { Button, FAB } from \"@react-native-material/core\";\r\nimport moment from \"moment\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { changeInfo } from \"../features/userStore\";\r\nimport { changeInfoUser, entradaTikada, salidaTikada } from \"../api\";\r\nimport fondo from \"../assets/fondoScreen.jpg\";\r\n\r\n\r\nexport default function App({ navigation }) {\r\n  const [location, setLocation] = useState(null);\r\n  const [errorMsg, setErrorMsg] = useState(null);\r\n  const [fecha, setFecha] = useState(null);\r\n\r\n  const user = useSelector((state) => state.userStore);\r\n  const dispatch = useDispatch();\r\n\r\n  const handleTikado = () => {\r\n    if (user.tikado == false) {\r\n      dispatch(changeInfo(!user.tikado));\r\n      changeInfoUser(user._id, !user.tikado);\r\n      const newTikada = {\r\n        idEmpleado: user._id,\r\n        estado: \"abierta\",\r\n        entrada: fecha,\r\n        salida: \"Ninguna\",\r\n        mes: \"Septiembre\",\r\n        comentario: \"Ninguno\",\r\n      };\r\n      entradaTikada(newTikada);\r\n      navigation.navigate(\"TabScreen\");\r\n    } else {\r\n      Alert.alert(\"No puedes tikar la entrada si ya has tikado\");\r\n    }\r\n  };\r\n\r\n  const handleSalida = () => {\r\n    if (user.tikado == true) {\r\n      dispatch(changeInfo(!user.tikado));\r\n      changeInfoUser(user._id, !user.tikado);\r\n      const newSalida = {\r\n        salida: fecha,\r\n      };\r\n      salidaTikada(user._id, newSalida);\r\n      navigation.navigate(\"TabScreen\");\r\n    } else {\r\n      Alert.alert(\"No puedes tikar la salida si no has tikado la entrada\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      let { status } = await Location.requestForegroundPermissionsAsync();\r\n      if (status !== \"granted\") {\r\n        setErrorMsg(\"Permission to access location was denied\");\r\n        return;\r\n      }\r\n\r\n      let location = await Location.getCurrentPositionAsync({});\r\n      setLocation(location);\r\n    })();\r\n    const newDay = moment().format(\"DD/MM/YYYY HH:mm:ss \");\r\n    setFecha(newDay);\r\n  }, []);\r\n\r\n  let text = \"Waiting..\";\r\n  if (errorMsg) {\r\n    text = errorMsg;\r\n  } else if (location) {\r\n    text = JSON.stringify(location);\r\n  }\r\n  return (\r\n    <View>\r\n      {location === null ? (\r\n        <ImageBackground\r\n          source={fondo}\r\n          resizeMode=\"cover\"\r\n          style={{ flex: 1, justifyContent: \"center\" }}\r\n        ></ImageBackground>\r\n      ) : (\r\n        <>\r\n          <View\r\n            style={{\r\n              position: \"absolute\",\r\n              zIndex: 1000,\r\n              backgroundColor: \"#00000099\",\r\n              height: 150,\r\n              width: \"90%\",\r\n              top: \"5%\",\r\n              left: \"5%\",\r\n              right: 0,\r\n              bottom: 40,\r\n              padding: 10,\r\n              borderRadius: 5,\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            <View\r\n              style={{\r\n                backgroundColor: \"#ffffff\",\r\n                width: \"80%\",\r\n                height: 50,\r\n                marginVertical: 10,\r\n                borderRadius: 10,\r\n                justifyContent: \"center\",\r\n              }}\r\n            >\r\n              <Text style={{ textAlign: \"center\", fontSize: 18 }}>{fecha}</Text>\r\n            </View>\r\n            <View style={{ flexDirection: \"row\" }}>\r\n              <Button\r\n                onPress={handleTikado}\r\n                title=\"Entrada\"\r\n                style={{\r\n                  marginRight: 5,\r\n                  backgroundColor: \"green\",\r\n                  width: 145,\r\n                  padding: 5,\r\n                }}\r\n              />\r\n              <Button\r\n                onPress={handleSalida}\r\n                title=\"Salida\"\r\n                style={{ backgroundColor: \"red\", width: 145, padding: 5 }}\r\n              />\r\n            </View>\r\n          </View>\r\n          <MapView\r\n            region={{\r\n              latitude: location.coords.latitude,\r\n              longitude: location.coords.longitude,\r\n              latitudeDelta: 0.0922,\r\n              longitudeDelta: 0.0421,\r\n            }}\r\n            style={{ width: \"100%\", height: \"100%\" }}\r\n          >\r\n            <Marker\r\n              key=\"1\"\r\n              coordinate={{\r\n                latitude: location.coords.latitude,\r\n                longitude: location.coords.longitude,\r\n              }}\r\n              title=\"Dia 5\"\r\n              description=\"Hora: 20:00\"\r\n            >\r\n              <Callout tooltip={true} />\r\n            </Marker>\r\n          </MapView>\r\n        </>\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}